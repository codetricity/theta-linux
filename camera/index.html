
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Configure Linux computers like the Jetson Nano to stream and use RICOH THETA USB API">
      
      
        <meta name="author" content="Oppkey">
      
      
      <link rel="icon" href="../images/logo-white.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.5.0">
    
    
      
        <title>Camera - RICOH THETA Development on Linux</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2e8b5541.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#8bc34b">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-73311422-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");ga("send","event","feedback","click",t,e),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){ga("send","pageview",e.pathname)})});var e=document.createElement("script");e.async=!0,e.src="https://www.google-analytics.com/analytics.js",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="light-green" data-md-color-accent="lime">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#streaming-specifications" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="RICOH THETA Development on Linux" class="md-header__button md-logo" aria-label="RICOH THETA Development on Linux" data-md-component="logo">
      
  <img src="../images/logo-white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RICOH THETA Development on Linux
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Camera
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="RICOH THETA Development on Linux" class="md-nav__button md-logo" aria-label="RICOH THETA Development on Linux" data-md-component="logo">
      
  <img src="../images/logo-white.png" alt="logo">

    </a>
    RICOH THETA Development on Linux
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../equipment/" class="md-nav__link">
        Equipment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../software/" class="md-nav__link">
        Software
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../demos/" class="md-nav__link">
        Demos
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../usb_api/" class="md-nav__link">
        USB API
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Camera
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Camera
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#streaming-specifications" class="md-nav__link">
    Streaming Specifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#long-term-streaming" class="md-nav__link">
    Long-Term Streaming
  </a>
  
    <nav class="md-nav" aria-label="Long-Term Streaming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#long-term-streaming-platform-tests" class="md-nav__link">
    Long-term Streaming Platform Tests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sleep-and-power-overview" class="md-nav__link">
    Sleep and Power Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sleep-and-wake" class="md-nav__link">
    Sleep and Wake
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#power-off-and-power-on" class="md-nav__link">
    Power Off and Power On
  </a>
  
    <nav class="md-nav" aria-label="Power Off and Power On">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#turn-camera-off" class="md-nav__link">
    Turn Camera Off
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-camera-on-using-jetson-nano" class="md-nav__link">
    Turn Camera On Using Jetson Nano
  </a>
  
    <nav class="md-nav" aria-label="Turn Camera On Using Jetson Nano">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-code-for-jetson-nano" class="md-nav__link">
    Sample Code for Jetson Nano
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-camera-on-using-raspberry-pi" class="md-nav__link">
    Turn Camera On Using Raspberry Pi
  </a>
  
    <nav class="md-nav" aria-label="Turn Camera On Using Raspberry Pi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-libusb-dev" class="md-nav__link">
    install libusb-dev
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-hub-ctrlc" class="md-nav__link">
    install hub-ctrl.c
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-shell-script-to-cycle-power" class="md-nav__link">
    create shell script to cycle power
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-enable-script-to-run-without-sudo-password" class="md-nav__link">
    Optional - Enable script to run without sudo password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-tips-for-raspberry-pi-4" class="md-nav__link">
    Additional Tips for Raspberry Pi 4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../optimization/" class="md-nav__link">
        Optimization
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../viewer/" class="md-nav__link">
        Image Viewer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../help/" class="md-nav__link">
        Help
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../meetup/" class="md-nav__link">
        Meetup Archive
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#streaming-specifications" class="md-nav__link">
    Streaming Specifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#long-term-streaming" class="md-nav__link">
    Long-Term Streaming
  </a>
  
    <nav class="md-nav" aria-label="Long-Term Streaming">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#long-term-streaming-platform-tests" class="md-nav__link">
    Long-term Streaming Platform Tests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sleep-and-power-overview" class="md-nav__link">
    Sleep and Power Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sleep-and-wake" class="md-nav__link">
    Sleep and Wake
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#power-off-and-power-on" class="md-nav__link">
    Power Off and Power On
  </a>
  
    <nav class="md-nav" aria-label="Power Off and Power On">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#turn-camera-off" class="md-nav__link">
    Turn Camera Off
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-camera-on-using-jetson-nano" class="md-nav__link">
    Turn Camera On Using Jetson Nano
  </a>
  
    <nav class="md-nav" aria-label="Turn Camera On Using Jetson Nano">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sample-code-for-jetson-nano" class="md-nav__link">
    Sample Code for Jetson Nano
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-camera-on-using-raspberry-pi" class="md-nav__link">
    Turn Camera On Using Raspberry Pi
  </a>
  
    <nav class="md-nav" aria-label="Turn Camera On Using Raspberry Pi">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-libusb-dev" class="md-nav__link">
    install libusb-dev
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#install-hub-ctrlc" class="md-nav__link">
    install hub-ctrl.c
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-shell-script-to-cycle-power" class="md-nav__link">
    create shell script to cycle power
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-enable-script-to-run-without-sudo-password" class="md-nav__link">
    Optional - Enable script to run without sudo password
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-tips-for-raspberry-pi-4" class="md-nav__link">
    Additional Tips for Raspberry Pi 4
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Camera</h1>

<p>You need a THETA V or Z1.  These cameras live stream
with UVC 1.5 in equirectangular.
You can also use a THETA S to stream motionJPEG in dual-fisheye.</p>
<h2 id="streaming-specifications">Streaming Specifications</h2>
<p>V and Z1 USB streaming.</p>
<ul>
<li>4K，H264: 3840×1920/29.97fps/120Mbps</li>
<li>2K，H264: 1920×960/29.97fps/42Mbps</li>
</ul>
<p>The modes for the sample program 
are specified in <a href="https://github.com/ricohapi/libuvc-theta-sample/blob/f8c3caa32bf996b29c741827bd552be605e3e2e2/gst/thetauvc.c#L55">thetauvc.c</a>.</p>
<p>You can specify the resolution in <a href="https://github.com/ricohapi/libuvc-theta-sample/blob/f8c3caa32bf996b29c741827bd552be605e3e2e2/gst/gst_viewer.c#L248">gst_viewer.c</a>.  An example of changing the resolution is <a href="https://github.com/codetricity/libuvc-theta-sample">here</a>.</p>
<h2 id="long-term-streaming">Long-Term Streaming</h2>
<p>With firmware 1.60.1 or newer, the Z1 can stream indefinitely.
The battery will charge when streaming at 4K.  To stream indefinitely,
you need the proper equipment.  </p>
<p>The USB port supplying charge to the RICOH THETA needs to supply approximately 900mA of
current.</p>
<p>In my tests, most USB 3.0, 3.1, and 3.2 ports on Linux computers did not supply the
required electrical current.</p>
<p>If your computer does not supply 900mA of charge while streaming data, you will need
to use a powered hub with the proper specification.</p>
<p>There are different standards for Battery Charging 1.2 for the USB electrical
specification. You will need BC 1.2 CDP to provide 1.5A data plus charge.  The
THETA Z1 will only consume 0.9A of the 1.5A capacity.</p>
<p><img alt="Battery Charging 1.2 table" src="../images/camera/bc_1_2_table.png" /></p>
<p>It's likely that USB Type-C (not USB 3.0 with a USB-C connector) and USB PD can
also deliver over 900mA, but I did not test these.  Note that my Asus Zephyrus laptop
has USB-C connector ports directly the laptop body, but these physical ports comply to the
USB 3.2 specification, not USB-C.  USB 3.2 does not require USB Power Delivery.</p>
<p>From the table below, it would appear that USB 3.2 Gen 2 would deliver the required
electrical current.  However, I wasn't able to keep the Z1 charged indefinitely at 4K
with my ROG Zephyrus G14 GA401.</p>
<p><img alt="USB Power Table" src="../images/camera/usb_power.png" /></p>
<p>Here's the specifications on my laptop.</p>
<p><img alt="Zephyrus laptop specifications" src="../images/camera/zephyrus.png" /></p>
<p>After testing streaming on 5 different
computers, I could only achieve continuous non-stop streaming on one computer.</p>
<p>From our community tests, it appears that the USB 3.0 (or 3.1, 3.2) port needs
to support Battery Charging 1.2 or equivalent.  The Z1 consumes 0.6Amp to 0.9Amps while
streaming 4K.  Without a powered hub, the Raspberry Pi and Jetson Nano cannot
stream indefinitely.</p>
<p>I tested an old <a href="https://www.anker.com/products/variant/7-port-usb-30-hub-/A7505112">Anker 7-Port USB 3.0 hub</a>
that I had on my desk with a Jetson Nano.
The Z1 battery charge increased while it was streaming at 4K.  The Z1 camera body
remained comfortably warm when I touched it, not hot.</p>
<p>In the test setup below, the Anker USB hub is plugged into a power strip. The hub is above
my keyboard.</p>
<p><img alt="Z1 test setup with hub" src="../images/camera/z1_test_setup.png" /></p>
<p>The hub that I am using only has one port that is BC 1.2 compliant.  I needed to use
the BC 1.2 port. </p>
<p><img alt="Anker hub" src="../images/camera/anker_hub.png" /></p>
<p>If I plugged the Z1 into the other 6 ports, the camera would only consume 0.440 Amps.
This is the same electrical current consumption that I saw on the USB 3.1 and 3.2 ports
of the computers I tested.  With the Z1 drawing 0.440 Amps, the battery will drain during streaming.</p>
<p>Using the BC 1.2 port, the camera draws up to 0.8 Amps to 0.9 Amps while charging and streaming.</p>
<p><img alt="Current Draw" src="../images/camera/current_draw.png" /></p>
<p>After the camera passes 90 percent charge, the charging rate appears to slow down. After a long
4K streaming session on the Nano, the Z1 is staying happy at 95 percent charge.</p>
<p><img alt="Z1 charge" src="../images/camera/z1_charge.png" /></p>
<h3 id="long-term-streaming-platform-tests">Long-term Streaming Platform Tests</h3>
<table>
<thead>
<tr>
<th>Platform</th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr>
<td>Acer Predator 300 laptop with onboard USB 3.1 ports</td>
<td>success. battery charged while streaming</td>
</tr>
<tr>
<td>Jetson Nano with external powered USB hub with BC 1.2</td>
<td>success. battery charged.</td>
</tr>
<tr>
<td>Jetson Nano using onboard USB 3 ports</td>
<td>fail. battery drained.</td>
</tr>
<tr>
<td>Desktop computer with Intel X99 Wellsburg motherboard and USB 3.1 ports</td>
<td>fail. battery drained</td>
</tr>
<tr>
<td>Asus Zephyrus laptop with USB 3.2 ports</td>
<td>fail. battery drained</td>
</tr>
<tr>
<td>desktop computer with Intel B85 motherboard and USB 3.0 ports</td>
<td>fail. battery drained</td>
</tr>
</tbody>
</table>
<h2 id="sleep-and-power-overview">Sleep and Power Overview</h2>
<p>The camera has three power states:</p>
<ol>
<li>Power off</li>
<li>Power on</li>
<li>Sleep</li>
</ol>
<p>You can use the THETA API over a USB cable to control power off, sleep, and awake.
To turn on the camera from power off, you can use a C library to power cycle the
USB ports on a small board computer such as a Jetson Nano. This is an unofficial
community workaround and is not supported by RICOH.</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Method</th>
</tr>
</thead>
<tbody>
<tr>
<td>Sleep</td>
<td>USB API</td>
</tr>
<tr>
<td>Awake</td>
<td>USB API</td>
</tr>
<tr>
<td>Power Off</td>
<td>USB API</td>
</tr>
<tr>
<td>Power On</td>
<td>workaround with C library</td>
</tr>
</tbody>
</table>
<h2 id="sleep-and-wake">Sleep and Wake</h2>
<p>If your application can provide power to the
THETA or if the THETA does not have to be dormant for a long time, it is better to use
sleep and awake. You can use the USB API to control sleep and awake. </p>
<p>We used the following process to test sleep and awake:</p>
<ol>
<li><a href="../usb_api/#auto-power-off-delay">Disable auto power off delay</a> and disable auto sleep - you only need to do this once.
The camera will save the setting.</li>
<li><a href="../usb_api/#put-camera-to-sleep">Put camera to sleep</a></li>
<li><a href="../usb_api/#wake-camera-from-sleep">Wake camera from sleep</a></li>
<li>Check if camera status is ready. If the camera is still asleep, send the wake camera again.</li>
</ol>
<p>If you do not have any problems waking the camera up from sleep on the first attempt, you may not need step 4.</p>
<h2 id="power-off-and-power-on">Power Off and Power On</h2>
<p>If you require power off and power on for applications such as placing the THETA on 
a robot, then shipping the robot to another site, you can use a Nano 
or Raspberry Pi to power on the THETA.</p>
<h3 id="turn-camera-off">Turn Camera Off</h3>
<p>The camera can be turned off with the USB API.</p>
<pre><code>$ ptpcam -R 0x1013
</code></pre>
<h3 id="turn-camera-on-using-jetson-nano">Turn Camera On Using Jetson Nano</h3>
<p>There is no official way to turn on the camera once it is in a power off state.
We recommend that you use sleep and awake.  If this is not an option,
you can turn the camera on by power cycling the USB ports of the Jetson Nano.</p>
<p>This example uses libusb.</p>
<h4 id="sample-code-for-jetson-nano">Sample Code for Jetson Nano</h4>
<pre><code class="language-c">/**************** 
* Tested on Jetson Nano running JetPack 4.4
* The RICOH THETA V and Z1 will turn on from a power off state when 
* the USB cable is plugged into a port. This example  will power cycle
* the USB ports of the Nano.  You must have libusb-1.0-0-dev installed
* on the Nano and link to it.
* 
* Additional information on using libusb_control_transfer is below. 
* https://www.cs.unm.edu/~hjelmn/libusb_hotplug_api/group__syncio.html
*****************/

#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;stdint.h&gt;
#include &lt;unistd.h&gt;
#include &lt;libusb-1.0/libusb.h&gt;

unsigned        vid = 0x0bda;
unsigned        pid = 0x5411;


int power_cycle(libusb_device_handle *hub_devh)
{
        int ret = -1;

        /*ep0 vendor command enable*/
        ret = libusb_control_transfer(hub_devh, 0x40, 0x02, 0x01, ((0x0B&lt;&lt;8)|(0xDA)), 0, 0, 100000);
        if (ret &lt; 0) {
                printf(&quot;[error]:ep0 vendor command enable fail.\n&quot;);
                return ret;
        }

        /*ep0 vendor command disable*/
        libusb_control_transfer(hub_devh, 0x40, 0x1, 0x08, 0, NULL, 0, 100);
        libusb_control_transfer(hub_devh, 0x40, 0x3, 0x08, 0, NULL, 0, 100);
        libusb_control_transfer(hub_devh, 0x40, 0x02, 0x00, ((0x0B&lt;&lt;8)|(0xDA)), 0, 0, 100000);

        return ret;
}

int main(int argc, char *argv[])
{
    int ret=0;
    libusb_device_handle    *hub_devh;
    libusb_context      *context;

    ret = libusb_init(&amp;context);
    if (ret != 0){
        printf(&quot;[error]:libusb init fail.\n&quot;);
        return ret;
    }

    hub_devh = libusb_open_device_with_vid_pid(context, vid, pid);
    if (!hub_devh) {
        printf(&quot;[error]:open device %04x:%04x fail.\n&quot;, vid, pid);
        return -1;
    }
    ret = power_cycle(hub_devh);
    return ret;
}
</code></pre>
<p>You can test the code by first saving the code in a file called, 
<code>reset_jetson_usb_power.c</code> then follow these steps:</p>
<pre><code class="language-bash">$ sudo apt-get install libusb-1.0-0-dev
$ gcc -o power_cycle reset_jetson_usb_power.c -lusb-1.0
$ sudo ./power_cycle
</code></pre>
<h3 id="turn-camera-on-using-raspberry-pi">Turn Camera On Using Raspberry Pi</h3>
<h4 id="install-libusb-dev">install libusb-dev</h4>
<p><code>sudo apt-get install libusb-dev</code></p>
<h4 id="install-hub-ctrlc">install hub-ctrl.c</h4>
<p><code>git clone https://github.com/codetricity/hub-ctrl.c</code></p>
<ul>
<li>make and then install in <code>/usr/local/bin</code></li>
</ul>
<h4 id="create-shell-script-to-cycle-power">create shell script to cycle power</h4>
<p>Save the following into <code>/usr/local/sbin/cycle-power.sh</code>.</p>
<pre><code class="language-bash">#!/bin/bash
/usr/local/bin/hub-ctrl -h 0 -P 2 -p 0 
sleep 2
/usr/local/bin/hub-ctrl -h 0 -P 2 -p 1
</code></pre>
<h4 id="optional-enable-script-to-run-without-sudo-password">Optional - Enable script to run without sudo password</h4>
<p>This is a potential security risk.  If you want to avoid having to enter
a password and are comfortable with the risk, then follow the steps
in <a href="https://askubuntu.com/questions/155791/how-do-i-sudo-a-command-in-a-script-without-being-asked-for-a-password">this article</a>.</p>
<h4 id="additional-tips-for-raspberry-pi-4">Additional Tips for Raspberry Pi 4</h4>
<p>Thanks to Shun Yamashita of <a href="https://fulldepth.co.jp/">fulldepth</a> for this solution
to cycle the power on the Raspberry Pi 4 USB ports, which has the effect of turning
the THETA Z1 on when it is plugged in with a USB cable. </p>
<p>Shun reported that with the Raspberry Pi 4, the script above did not work.  He wrote
the script below for the RPi 4 which does work.</p>
<pre><code class="language-bash">#!/bin/bash

ptpcam -R 0x1013

/usr/local/bin/hub-ctrl -h 0 -P 1 -p 0
/usr/local/bin/hub-ctrl -h 0 -P 2 -p 0
/usr/local/bin/hub-ctrl -h 0 -P 3 -p 0
/usr/local/bin/hub-ctrl -h 0 -P 4 -p 0
/usr/local/bin/hub-ctrl -h 1 -P 1 -p 0
/usr/local/bin/hub-ctrl -h 1 -P 2 -p 0
/usr/local/bin/hub-ctrl -h 1 -P 3 -p 0
/usr/local/bin/hub-ctrl -h 1 -P 4 -p 0
/usr/local/bin/hub-ctrl -v

sleep 5

/usr/local/bin/hub-ctrl -h 0 -P 1 -p 1
/usr/local/bin/hub-ctrl -h 0 -P 2 -p 1
/usr/local/bin/hub-ctrl -h 0 -P 3 -p 1
/usr/local/bin/hub-ctrl -h 0 -P 4 -p 1
/usr/local/bin/hub-ctrl -h 1 -P 1 -p 1
/usr/local/bin/hub-ctrl -h 1 -P 2 -p 1
/usr/local/bin/hub-ctrl -h 1 -P 3 -p 1
/usr/local/bin/hub-ctrl -h 1 -P 4 -p 1
/usr/local/bin/hub-ctrl -v
</code></pre>


  




                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../usb_api/" class="md-footer__link md-footer__link--prev" aria-label="Previous: USB API" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              USB API
            </div>
          </div>
        </a>
      
      
        
        <a href="../optimization/" class="md-footer__link md-footer__link--next" aria-label="Next: Optimization" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Optimization
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://github.com/theta360developers" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/theta360dev" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.facebook.com/theta360guide/" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.48f2be22.min.js"></script>
      
    
  </body>
</html>