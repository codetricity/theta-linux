{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"RICOH THETA USB API For Jetson Nano Control the RICOH THETA from a Jetson Nano with a USB cable. Overview You can stream 4K video from a RICOH THETA V or RICOH THETA Z1 over a USB cable to a Linux computer. Information on the setup and usage of Linux live streaming is available on the thet360.guide Linux Streaming Site In addition to streaming the camera, you may want to start the stream, put the camera to sleep and wake the camera up from sleep using the USB cable.","title":"Home"},{"location":"#ricoh-theta-usb-api-for-jetson-nano","text":"Control the RICOH THETA from a Jetson Nano with a USB cable.","title":"RICOH THETA USB API For Jetson Nano"},{"location":"#overview","text":"You can stream 4K video from a RICOH THETA V or RICOH THETA Z1 over a USB cable to a Linux computer. Information on the setup and usage of Linux live streaming is available on the thet360.guide Linux Streaming Site In addition to streaming the camera, you may want to start the stream, put the camera to sleep and wake the camera up from sleep using the USB cable.","title":"Overview"},{"location":"usb_api/","text":"USB API with libptp Equipment Jetson Nano 5V 4amp power connector, set to 10amp PWM fan blowing on heatsink and powered from the Nano board Jetpack 4.4, which is Ubuntu 18.04.5 LTS, Bionic Beaver RICOH THETA V drawing power over USB cable from Nano Download libptp source libptp - Picture Transfer Protocol lib Get the newest version, which is 2-1.2 right now. build libptp $ ./configure $ make If you have a build error when compiling libusb, you may need to install the development libraries for libusb. install libusb-dev $ sudo apt install libusb-dev You may not need this step if you already have the libusb development libraries installed. install libptp $ sudo make install set /usr/local/lib in library path The default location of the libptp install is /usr/local/lib . Make sure that this is in your library path. If it isn't, add it to a file such as libc.conf in /etc/ld.so.conf/ . $ cd /etc/ld.so.conf.d/ $ ls $ cat libc.conf run ldconfig Load the library configuration. $ sudo /sbin/ldconfig -v Test ptpcam Connect RICOH THETA to Jetson with a USB cable. Version of 2-1.2 of libptp has a bug in it. Although ptpcam does take pictures and function normally, you will see an error about capture status. Fix problem with libptp response Go to line 77 of ptp.h and change PTP_USB_INT_PACKET_LEN to 28 . After modification, the code will look like this. test ptpcam response again Take a still image picture with ptpcam --capture . Set camera to live streaming mode Check on camera mode. $ ptpcam --show-property=0x5013 Set to live streaming mode. $ ptpcam --set-property=0x5013 --val=0x8005 Using the official RICOH USB API documentation , you can verify that 0x8005 is live streaming mode. The camera LED should show that the THETA is in LIVE mode. In our tests, the RICOH THETA Z1 could charge while streaming over a USB 3.0 port (blue insert). After hours of streaming, the Z1 LED looks like this. The response codes are shown below. 0x0001 = single-shot shooting 0x0003 = Interval shooting 0x8002 = Movie shooting 0x8003 = Interval composite shooting 0x8004 = Multi bracket shooting 0x8005 = Live streaming 0x8006 = Interval shooting - tripod stabilizatio is off (top/bottom correction and stitching optimized) 0x8007 = Interval shooting - tripod stabilization is on If you set the camera back to still image, single shot mode, you will see this response. $ ptpcam --set-property=0x5013 --val=0x0001 Camera: RICOH THETA V 'Still Capture Mode' is set to: 0x8005 (-32763) Changing property value to 0x0001 [(null)] succeeded.","title":"USB API"},{"location":"usb_api/#usb-api-with-libptp","text":"","title":"USB API with libptp"},{"location":"usb_api/#equipment","text":"Jetson Nano 5V 4amp power connector, set to 10amp PWM fan blowing on heatsink and powered from the Nano board Jetpack 4.4, which is Ubuntu 18.04.5 LTS, Bionic Beaver RICOH THETA V drawing power over USB cable from Nano","title":"Equipment"},{"location":"usb_api/#download-libptp-source","text":"libptp - Picture Transfer Protocol lib Get the newest version, which is 2-1.2 right now.","title":"Download libptp source"},{"location":"usb_api/#build-libptp","text":"$ ./configure $ make If you have a build error when compiling libusb, you may need to install the development libraries for libusb.","title":"build libptp"},{"location":"usb_api/#install-libusb-dev","text":"$ sudo apt install libusb-dev You may not need this step if you already have the libusb development libraries installed.","title":"install libusb-dev"},{"location":"usb_api/#install-libptp","text":"$ sudo make install","title":"install libptp"},{"location":"usb_api/#set-usrlocallib-in-library-path","text":"The default location of the libptp install is /usr/local/lib . Make sure that this is in your library path. If it isn't, add it to a file such as libc.conf in /etc/ld.so.conf/ . $ cd /etc/ld.so.conf.d/ $ ls $ cat libc.conf","title":"set /usr/local/lib in library path"},{"location":"usb_api/#run-ldconfig","text":"Load the library configuration. $ sudo /sbin/ldconfig -v","title":"run ldconfig"},{"location":"usb_api/#test-ptpcam","text":"Connect RICOH THETA to Jetson with a USB cable. Version of 2-1.2 of libptp has a bug in it. Although ptpcam does take pictures and function normally, you will see an error about capture status.","title":"Test ptpcam"},{"location":"usb_api/#fix-problem-with-libptp-response","text":"Go to line 77 of ptp.h and change PTP_USB_INT_PACKET_LEN to 28 . After modification, the code will look like this.","title":"Fix problem with libptp response"},{"location":"usb_api/#test-ptpcam-response-again","text":"Take a still image picture with ptpcam --capture .","title":"test ptpcam response again"},{"location":"usb_api/#set-camera-to-live-streaming-mode","text":"Check on camera mode. $ ptpcam --show-property=0x5013 Set to live streaming mode. $ ptpcam --set-property=0x5013 --val=0x8005 Using the official RICOH USB API documentation , you can verify that 0x8005 is live streaming mode. The camera LED should show that the THETA is in LIVE mode. In our tests, the RICOH THETA Z1 could charge while streaming over a USB 3.0 port (blue insert). After hours of streaming, the Z1 LED looks like this. The response codes are shown below. 0x0001 = single-shot shooting 0x0003 = Interval shooting 0x8002 = Movie shooting 0x8003 = Interval composite shooting 0x8004 = Multi bracket shooting 0x8005 = Live streaming 0x8006 = Interval shooting - tripod stabilizatio is off (top/bottom correction and stitching optimized) 0x8007 = Interval shooting - tripod stabilization is on If you set the camera back to still image, single shot mode, you will see this response. $ ptpcam --set-property=0x5013 --val=0x0001 Camera: RICOH THETA V 'Still Capture Mode' is set to: 0x8005 (-32763) Changing property value to 0x0001 [(null)] succeeded.","title":"Set camera to live streaming mode"}]}